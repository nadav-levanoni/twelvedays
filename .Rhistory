sing_day(xmas, 2, Full.Phrase)
sing_line <- function(day, data){
print(data[as.integer(day)])
#print(data[as.integer(day)]$Full.Phrase)
return(data[as.integer(day)])
}
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_day <- function(dataset, line, phrase_col){
#phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line)]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
#print(as.integer(line):1)
#print(dataset)
body <- map_chr(as.integer(line):1, ~sing_line(.x, dataset$Full.Phrase))
#print(body)
}
sing_day(xmas, 2, Full.Phrase)
sing_day(xmas, 1, Full.Phrase)
sing_day(xmas, 12, Full.Phrase)
sing_day(xmas, 11, Full.Phrase)
sing_day(xmas, 9, Full.Phrase)
sing_day(xmas, 4, Full.Phrase)
sing_day(xmas, 7, Full.Phrase)
sing_day(xmas, 8, Full.Phrase)
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_day <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line)]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
#print(as.integer(line):1)
#print(dataset)
body <- map_chr(as.integer(line):1, ~sing_line(.x, phrases))
#print(body)
}
sing_day(xmas, 8, Full.Phrase)
sing_day(xmas, 7, Full.Phrase)
sing_day(xmas, 8, Full.Phrase)
sing_day(xmas, 7, Full.Phrase)
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_day <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line)]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_line(.x, phrases))
#print(body)
}
sing_day(xmas, 7, Full.Phrase)
xmas[8]
xmas.loc[8]
xmas.loc[8, ]
xmas[8, ]
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_day <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_line(.x, phrases))
#print(body)
}
sing_day(xmas, 7, Full.Phrase)
sing_day(xmas, 8, Full.Phrase)
sing_day(xmas, 9, Full.Phrase)
sing_day(xmas, 12, Full.Phrase)
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_day <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_line(.x, phrases))
return(cat(head, body, "\n"))
}
sing_day(xmas, 12, Full.Phrase)
sing_line <- function(day, data){
return(data[as.integer(day)])
}
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_day <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_line(.x, phrases))
return(cat(head, body, "\n"))
}
sing_day(xmas, 12, Full.Phrase)
return(cat(head, body, by = "\n"))
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_day <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_line(.x, phrases))
str_c(c(head, body), collapse = "\n")
}
sing_day(xmas, 12, Full.Phrase)
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_day <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_line(.x, phrases))
str_c(c(head, body), collapse = "\\n")
}
sing_day(xmas, 12, Full.Phrase)
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_day <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_line(.x, phrases))
str_c(c(head, body), collapse = "\n")
}
sing_day(xmas, 12, Full.Phrase)
return(as.str(str_c(c(head, body), collapse = "\n")))
return(as.chr(str_c(c(head, body), collapse = "\n")))
return(as.character(str_c(c(head, body), collapse = "\n")))
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_day <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_line(.x, phrases))
return(as.character(str_c(c(head, body), collapse = "\n")))
}
sing_day(xmas, 12, Full.Phrase)
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_day <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,\n")
body <- map_chr(as.integer(line):1, ~sing_line(.x, phrases))
return(str_c(c(head, body), collapse = "\n"))
}
sing_day(xmas, 12, Full.Phrase)
print(sing_day(xmas, 12, Full.Phrase))
print(sing_day(xmas, 12, Full.Phrase))
writeLines(sing_day(xmas, 12, Full.Phrase))
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_day <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_line(.x, phrases))
return(str_c(c(head, body), collapse = "\n"))
}
writeLines(sing_day(xmas, 12, Full.Phrase))
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_line <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_day(.x, phrases))
return(str_c(c(head, body), collapse = "\n"))
}
sing_day <- function(day, data){
return(data[as.integer(day)])
}
knitr::opts_chunk$set(echo = TRUE)
writeLines(sing_line(xmas, 12, Full.Phrase))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
xmas <- read.csv("https://www.dropbox.com/s/e584pryn8evm1gz/xmas.csv?dl=1")
xmas <- xmas%>%
mutate(Gift.Item = pluralize_gift(xmas$Gift.Item))
make_phrase <- function(num, item, verb, adjective, location){
num <-  num_to_word(as.integer(num))
phrase <-  paste(num, item, verb, adjective, location)
phrase <-  str_trim(str_replace_all(phrase, " +", " "))
phrase <-  str_trim(str_replace_all(phrase, "\\-", " "))
phrase <-  tools::toTitleCase(phrase)
return(phrase)
}
num_to_word <- function(num){
nums <-  c("and", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", "eleven", "twelve")
return(nums[num])
}
#' @param gift A string or vector of strings
#'
#' @return A string or vector of strings with the pluralized words
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
pluralize_gift <- function(gift){
# set first item aside because its singular
modified = rep(0, 12)
modified[1] = 1
# modify special exception 6
excep_6 = str_detect(gift, "oose$")
gift = gift %>%
str_replace("oose$", "eese")
modified = modified + excep_6
# modify exception 9
excep_9 = str_detect(gift, "y$")
gift = gift %>%
str_replace("y$", "ies")
modified = modified + excep_9
# everything else
gift[!modified] <- str_replace(paste(gift[!modified], "s"), " ", "")
return(gift)
}
xmas <- xmas%>%
mutate(Gift.Item = pluralize_gift(xmas$Gift.Item))
xmas <- xmas%>%
mutate_all(~replace(., is.na(.), ""))
xmas <- xmas %>%
mutate(
Full.Phrase = pmap_chr(xmas, ~make_phrase(..1, ..3, ..4, ..5, ..6))
)
head(xmas)
writeLines(sing_line(xmas, 12, Full.Phrase))
writeLines(sing_line(xmas, 2, Full.Phrase))
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_line <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_day(.x, phrases))
body <- c(body, ".")
return(str_c(c(head, body), collapse = "\n"))
}
writeLines(sing_line(xmas, 2, Full.Phrase))
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_line <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_day(.x, phrases))
body <- c(body, ".")
song <- str_c(c(head, body), collapse = "\n")
song <- str_replace(song, "\n.". ".")
return(song)
}
writeLines(sing_line(xmas, 2, Full.Phrase))
writeLines(sing_line(xmas, 2, Full.Phrase))
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_line <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_day(.x, phrases))
body <- c(body, ".")
song <- str_c(c(head, body), collapse = "\n")
song <- str_replace(song, "\n.", ".")
return(song)
}
writeLines(sing_line(xmas, 2, Full.Phrase))
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_line <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_day(.x, phrases))
body <- c(body, ".")
song <- str_c(c(head, body), collapse = "\n")
song <- str_replace(song, "\n\\.", ".")
return(song)
}
writeLines(sing_line(xmas, 2, Full.Phrase))
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_line <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_day(.x, phrases))
body <- c(body, ".")
song <- str_c(c(head, body), collapse = ",\n")
song <- str_replace(song, "\n\\.", ".")
return(song)
}
writeLines(sing_line(xmas, 2, Full.Phrase))
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_line <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_day(.x, phrases))
body <- c(body, ".")
song <- str_c(c(head, body), collapse = ",\n")
song <- str_replace(song, "\n\\,.", ".")
return(song)
}
writeLines(sing_line(xmas, 2, Full.Phrase))
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_line <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_day(.x, phrases))
body <- c(body, ".")
song <- str_c(c(head, body), collapse = ",\n")
song <- str_replace(song, ",\n\\.", ".")
return(song)
}
writeLines(sing_line(xmas, 2, Full.Phrase))
#' contains the gift phrases
#'
#' @return A string singing the line of the song with all gifts for the given day + the header.
#'
#' @import stringr
#' @import dplyr
#' @import glue
#' @import purrr
#'
#' @export
sing_line <- function(dataset, line, phrase_col){
phrases <- dataset %>% pull({{phrase_col}})
day <-  dataset[as.integer(line), ]$Day.in.Words
head <-  paste("On the", day, "day of Christmas, my true love sent to me,")
body <- map_chr(as.integer(line):1, ~sing_day(.x, phrases))
body <- c(body, ".")
song <- str_c(c(head, body), collapse = ",\n")
song <- str_replace(song, ",\n\\.", ".")
song <- str_replace(song, ",,", ",")
return(song)
}
writeLines(sing_line(xmas, 2, Full.Phrase))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
xmas <- read.csv("https://www.dropbox.com/s/e584pryn8evm1gz/xmas.csv?dl=1")
xmas <- xmas%>%
mutate(Gift.Item = pluralize_gift(xmas$Gift.Item))
xmas <- xmas%>%
mutate_all(~replace(., is.na(.), ""))
xmas <- xmas %>%
mutate(
Full.Phrase = pmap_chr(xmas, ~make_phrase(..1, ..3, ..4, ..5, ..6))
)
head(xmas)
writeLines(sing_line(xmas, 2, Full.Phrase))
